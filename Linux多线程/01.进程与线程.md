# 进程与线程的区别
1. 进程是资源分配的最小单位，线程是操作系统调度的最小单位。
2. 进程之间的地址空间是独立的，同一进程的多个线程共享地址空间。
# 线程基本操作函数
>需要引入头文件`pthread.h`
## 获取线程id
每一个线程都有一个唯一的线程id，数据类型为`pthread_t`，是一个**无符号长整形数**。

```c
#include<bits/pthreadtypes.h>
typedef unsigned long int pthread_t;
```

在线程中想要获取该线程的id可以调用

```c
pthread_t pthread_self(void);
```
该函数会返回当前线程的id。
## 线程创建
```c
#include<pthread.h>
int pthread_create(pthread_t *thread, const pthread_attr_t *attr,
				  void *(*start_routine) (void *), void *arg);
```
在主线程中调用该函数可以创建一个子线程，需要传入以下参数：

- `thread`：线程id，传入一个指向`pthread_t`类型的指针，子线程创建成功后会将该子线程的id写入传入的内存地址。
- `attr`:线程的属性，一般指定为NULL，使用默认属性。
- `start_routine`:函数指针，用于指定子线程要执行的函数，子线程会执行该函数。
- `arg`:指定`start_routine`要用的参数，如果不需要参数指定为NULL。

如果线程创建成功返回0，失败则返回错误码。

## 线程退出

线程函数在结束时最好调用`pthread_exit()`以确保安全干净的退出线程，该函数会立刻结束当前线程，并且不会影响其他线程的正常运行。

```c
#include<pthread.h>
void pthread_exit(void* retval);
```

`retval`：传出参数，向线程回收者(一般是该子线程的主线程)传递退出信息，不需要可以设置为NULL。

执行完后不会返回到调用者，不会失败。

## 线程回收

子线程退出后其内核资源主要由主线程回收，线程库中的线程回收函数是`pthread_join`，即等待线程结束。

```c
#include<pthread.h>
int pthread_join(pthread_t thread, void** retval);
```

该函数是阻塞的，等待的子线程退出后才会解除阻塞，进行资源回收。

一次调用只能回收一个子线程，多个子线程需要回收则需要循环调用。

- `thread`：要回收的子线程的线程id
- `retval`：传出参数，接受子线程的退出信息，即`pthread_exit()`传递的数据，可以指定为NULL

调用成功返回0，失败返回错误码，错误码有以下几种可能：

- `EDEADLK`：可能引起死锁
- `EINVAL`：目标线程不可回收，或者已有其他线程回收了该线程
- `ESRCH`：目标线程不存在
